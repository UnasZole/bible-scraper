description: "English Standard Version (esv.org)"
bible:
  metadata:
    language: en
    systemName: engESV
    title: English Standard Version
    versification: KJV

  patterns:
    chapterUrl: "https://www.esv.org/{BOOK}+{CHAPTER}"
    chapterPublishedNumber: "{CHAPTER}"

  args:
    CHAPTER: = $i

  books:
    - osis: Gen
      names: [ Genesis ]
      args: { BOOK: Genesis }
      chapters: [ { from: 1, to: 50 } ]

    - osis: Exod
      names: [ Exodus ]
      args: { BOOK: Exodus }
      chapters: [ { from: 1, to: 40 } ]

    - osis: Lev
      names: [ Leviticus ]
      args: { BOOK: Leviticus }
      chapters: [ { from: 1, to: 27 } ]

    - osis: Num
      names: [ Numbers ]
      args: { BOOK: Numbers }
      chapters: [ { from: 1, to: 36 } ]

    - osis: Deut
      names: [ Deuteronomy ]
      args: { BOOK: Deuteronomy }
      chapters: [ { from: 1, to: 34 } ]

    - osis: Josh
      names: [ Joshua ]
      args: { BOOK: Joshua }
      chapters: [ { from: 1, to: 24 } ]

    - osis: Judg
      names: [ Judges ]
      args: { BOOK: Judges }
      chapters: [ { from: 1, to: 21 } ]

    - osis: Ruth
      args: { BOOK: Ruth }
      chapters: [ { from: 1, to: 4 } ]

    - osis: 1Sam
      names: [ 1 Samuel ]
      args: { BOOK: 1 Samuel }
      chapters: [ { from: 1, to: 31 } ]

    - osis: 2Sam
      names: [ 2 Samuel ]
      args: { BOOK: 2 Samuel }
      chapters: [ { from: 1, to: 24 } ]

    - osis: 1Kgs
      names: [ 1 Kings ]
      args: { BOOK: 1 Kings }
      chapters: [ { from: 1, to: 22 } ]

    - osis: 2Kgs
      names: [ 2 Kings ]
      args: { BOOK: 2 Kings }
      chapters: [ { from: 1, to: 25 } ]

    - osis: 1Chr
      names: [ 1 Chronicles ]
      args: { BOOK: 1 Chronicles }
      chapters: [ { from: 1, to: 29 } ]

    - osis: 2Chr
      names: [ 2 Chronicles ]
      args: { BOOK: 2 Chronicles }
      chapters: [ { from: 1, to: 36 } ]

    - osis: Ezra
      args: { BOOK: Ezra }
      chapters: [ { from: 1, to: 10 } ]

    - osis: Neh
      names: [ Nehemiah ]
      args: { BOOK: Nehemiah }
      chapters: [ { from: 1, to: 13 } ]

    - osis: Esth
      names: [ Esther ]
      args: { BOOK: Esther }
      chapters: [ { from: 1, to: 10 } ]

    - osis: Job
      args: { BOOK: Job }
      chapters: [ { from: 1, to: 42 } ]

    - osis: Ps
      names: [ Psalms, Psalm ]
      args: { BOOK: Psalms }
      chapters: [ { from: 1, to: 150 } ]

    - osis: Prov
      names: [ Proverbs ]
      args: { BOOK: Proverbs }
      chapters: [ { from: 1, to: 31 } ]

    - osis: Eccl
      names: [ Ecclesiastes ]
      args: { BOOK: Ecclesiastes }
      chapters: [ { from: 1, to: 12 } ]

    - osis: Song
      args: { BOOK: Song of Solomon }
      chapters: [ { from: 1, to: 8 } ]

    - osis: Isa
      names: [ Isaiah ]
      args: { BOOK: Isaiah }
      chapters: [ { from: 1, to: 66 } ]

    - osis: Jer
      names: [ Jeremiah ]
      args: { BOOK: Jeremiah }
      chapters: [ { from: 1, to: 52 } ]

    - osis: Lam
      names: [ Lamentations ]
      args: { BOOK: Lamentations }
      chapters: [ { from: 1, to: 5 } ]

    - osis: Ezek
      names: [ Ezekiel ]
      args: { BOOK: Ezekiel }
      chapters: [ { from: 1, to: 48 } ]

    - osis: Dan
      names: [ Daniel ]
      args: { BOOK: Daniel }
      chapters: [ { from: 1, to: 12 } ]

    - osis: Hos
      names: [ Hosea ]
      args: { BOOK: Hosea }
      chapters: [ { from: 1, to: 14 } ]

    - osis: Joel
      args: { BOOK: Joel }
      chapters: [ { from: 1, to: 4 } ]

    - osis: Amos
      args: { BOOK: Amos }
      chapters: [ { from: 1, to: 9 } ]

    - osis: Obad
      names: [ Obadiah ]
      args: { BOOK: Obadiah }
      chapters: [ { at: 1 } ]

    - osis: Jonah
      args: { BOOK: Jonah }
      chapters: [ { from: 1, to: 4 } ]

    - osis: Mic
      names: [ Micah ]
      args: { BOOK: Micah }
      chapters: [ { from: 1, to: 7 } ]

    - osis: Nah
      names: [ Nahum ]
      args: { BOOK: Nahum }
      chapters: [ { from: 1, to: 3 } ]

    - osis: Hab
      names: [ Habakkuk ]
      args: { BOOK: Habakkuk }
      chapters: [ { from: 1, to: 3 } ]

    - osis: Zeph
      names: [ Zephaniah ]
      args: { BOOK: Zephaniah }
      chapters: [ { from: 1, to: 3 } ]

    - osis: Hag
      names: [ Haggai ]
      args: { BOOK: Haggai }
      chapters: [ { from: 1, to: 2 } ]

    - osis: Zech
      names: [ Zechariah ]
      args: { BOOK: Zechariah }
      chapters: [ { from: 1, to: 14 } ]

    - osis: Mal
      names: [ Malachi ]
      args: { BOOK: Malachi }
      chapters: [ { from: 1, to: 4 } ]

    - osis: Matt
      names: [ Matthew ]
      args: { BOOK: Matthew }
      chapters: [ { from: 1, to: 28 } ]

    - osis: Mark
      args: { BOOK: Mark }
      chapters: [ { from: 1, to: 16 } ]

    - osis: Luke
      args: { BOOK: Luke }
      chapters: [ { from: 1, to: 24 } ]

    - osis: John
      args: { BOOK: John }
      chapters: [ { from: 1, to: 21 } ]

    - osis: Acts
      args: { BOOK: Acts }
      chapters: [ { from: 1, to: 28 } ]

    - osis: Rom
      names: [ Romans ]
      args: { BOOK: Romans }
      chapters: [ { from: 1, to: 16 } ]

    - osis: 1Cor
      names: [ 1 Corinthians ]
      args: { BOOK: 1+Corinthians }
      chapters: [ { from: 1, to: 16 } ]

    - osis: 2Cor
      names: [ 2 Corinthians ]
      args: { BOOK: 2+Corinthians }
      chapters: [ { from: 1, to: 13 } ]

    - osis: Gal
      names: [ Galatians ]
      args: { BOOK: Galatians }
      chapters: [ { from: 1, to: 6 } ]

    - osis: Eph
      names: [ Ephesians ]
      args: { BOOK: Ephesians }
      chapters: [ { from: 1, to: 6 } ]

    - osis: Phil
      names: [ Philippians ]
      args: { BOOK: Philippians }
      chapters: [ { from: 1, to: 4 } ]

    - osis: Col
      names: [ Colossians ]
      args: { BOOK: Colossians }
      chapters: [ { from: 1, to: 4 } ]

    - osis: 1Thess
      names: [ 1 Thessalonians ]
      args: { BOOK: 1 Thessalonians }
      chapters: [ { from: 1, to: 5 } ]

    - osis: 2Thess
      names: [ 2 Thessalonians ]
      args: { BOOK: 2 Thessalonians }
      chapters: [ { from: 1, to: 3 } ]

    - osis: 1Tim
      names: [ 1 Timothy ]
      args: { BOOK: 1 Timothy }
      chapters: [ { from: 1, to: 6 } ]

    - osis: 2Tim
      names: [ 2 Timothy ]
      args: { BOOK: 2 Timothy }
      chapters: [ { from: 1, to: 4 } ]

    - osis: Titus
      args: { BOOK: Titus }
      chapters: [ { from: 1, to: 3 } ]

    - osis: Phlm
      names: [ Phlm ]
      args: { BOOK: Philemon }
      chapters: [ { at: 1 } ]

    - osis: Heb
      names: [ Hebrews ]
      args: { BOOK: Hebrews }
      chapters: [ { from: 1, to: 13 } ]

    - osis: Jas
      names: [ James ]
      args: { BOOK: James }
      chapters: [ { from: 1, to: 5 } ]

    - osis: 1Pet
      names: [ 1 Peter ]
      args: { BOOK: 1 Peter }
      chapters: [ { from: 1, to: 5 } ]

    - osis: 2Pet
      names: [ 2 Peter ]
      args: { BOOK: 2 Peter }
      chapters: [ { from: 1, to: 3 } ]

    - osis: 1John
      names: [ 1 John ]
      args: { BOOK: 1 John }
      chapters: [ { from: 1, to: 5 } ]

    - osis: 2John
      names: [ 2 John ]
      args: { BOOK: 2 John }
      chapters: [ { at: 1 } ]

    - osis: 3John
      names: [ 3 John ]
      args: { BOOK: 3 John }
      chapters: [ { at: 1 } ]

    - osis: Jude
      args: { BOOK: Jude }
      chapters: [ { at: 1 } ]

    - osis: Rev
      names: [ Revelation ]
      args: { BOOK: Revelation }
      chapters: [ { from: 1, to: 22 } ]

html:
  elements: []

  externalParsers:
    # The section for a chapter has a data-reference attribute, with either the book and chapter,
    # Or just the book for books with a single chapter.
    - selector: "div#bible-content > section:is([data-reference=\"{BOOK} {CHAPTER}\"], [data-reference=\"{BOOK}\"])"
      nodeParser:
        nodes: []

        elements:
          - selector: "h3"
            contexts:
              - type: SECTION_TITLE
                descendants:
                  - type: TEXT
                    op: text

          - selector: "b.chapter-num"
            contexts:
              - type: VERSE
                op: literal=1

          - selector: "b.verse-num"
            contexts:
              - type: VERSE
                op: ownText

          - selector: ":is(p:not([class]), p.same-paragraph)"
            contexts:
              - type: PARAGRAPH_BREAK

          - selector: "section.line-group"
            contexts:
              - type: POETRY_STANZA_BREAK

          - selector: "p.line:not(.indent)"
            contexts:
              - type: POETRY_LINE_START
                op: literal=1

          - selector: "p.line.indent"
            contexts:
              - type: POETRY_LINE_START
                op: literal=2

          - selector: "u"
            withAncestors: [ INLINE_TEXT ]
            withoutAncestors: [ MARKUP ]
            contexts:
              - type: TEXT
                op: wholeText

        externalParsers:
          - selector: "sup.footnote > a"
            textParser:
              stringExtractor:
                op: attribute=title
              html:
                elements: []
                externalParsers:
                  - selector: "span.footnote-embedded"
                    nodeParser:
                      nodes:
                        - withoutAncestors: [ NOTE_MARKUP ]
                          contexts:
                            - type: TEXT
                              regexp: (.*)
                      elements:
                        - selector: "span.footnote-embedded"
                          contexts:
                            - type: NOTE

                        - selector: "i.catch-word"
                          contexts:
                            - type: CATCHPHRASE
                              descendants:
                                - type: TEXT
                                  op: text

                        - selector: "i:not(.catch-word)"
                          contexts:
                            - type: QUOTE
                              descendants:
                                - type: TEXT
                                  op: text

          - selector: "sup.crossref > a"
            contextsBefore:
              - type: NOTE
            textParser:
              stringExtractor:
                op: attribute=data-passage
              sliding:
                rules:
                  # Starting space : just normal text.
                  - regexp: " "
                    contexts:
                      - type: TEXT
                        literal: " "
                  # Reference to a single verse or verse range.
                  - regexp: "[a-zA-Z0-9 ]+ \\d+:\\d+(?:–\\d+)?(?:; |$)"
                    contexts:
                      - type: REFERENCE
                        descendants:
                          - type: FULL_REF
                            descendants:
                              - type: REF_BOOK
                                regexp: "^([a-zA-Z0-9 ]+) \\d+:\\d+(?:–\\d+)?;? ?$"
                              - type: REF_CHAPTER
                                regexp: "^[a-zA-Z0-9 ]+ (\\d+):\\d+(?:–\\d+)?;? ?$"
                              - type: REF_VERSES
                                regexp: "^[a-zA-Z0-9 ]+ \\d+:(\\d+(?:–\\d+)?);? ?$"
                          - type: TEXT
                            regexp: "(.*)"
